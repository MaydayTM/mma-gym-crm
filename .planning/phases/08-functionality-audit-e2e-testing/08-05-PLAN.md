---
phase: 08-functionality-audit-e2e-testing
plan: 05
type: execute
depends_on: ["08-01"]
files_modified: [e2e/settings-team.spec.ts, e2e/dashboard-misc.spec.ts]
---

<objective>
Write E2E tests for admin/settings pages, dashboard, and remaining pages. Final manual verification of the complete app.

Purpose: Complete the E2E test coverage for all remaining pages and perform a final human walkthrough.
Output: Full E2E test coverage across all app pages, manual verification confirmed.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-plan.md
./summary.md
~/.claude/get-shit-done/references/checkpoints.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/08-functionality-audit-e2e-testing/08-01-SUMMARY.md

# Key source files:
@src/pages/Settings.tsx
@src/pages/Team.tsx
@src/pages/Dashboard.tsx
@src/pages/Shop.tsx
@src/pages/Email.tsx
@src/pages/GymScreen.tsx
@src/pages/KitanaHub.tsx

**Established patterns:**
- Settings sections split: admin-only vs staff-accessible
- Sidebar uses permission field for visibility
- Shop module requires module access check

**Deferred to future:**
- DoorTest page (ISS-001/002 — hardware testing requires physical ESP32 access)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Write E2E tests for Settings and Team pages</name>
  <files>e2e/settings-team.spec.ts</files>
  <action>
Write `e2e/settings-team.spec.ts` with two describe blocks:

**`test.describe('Settings')`:**
Setup: login as admin, navigate to /settings.

1. **"should display settings page with tabs"** — expect tab navigation visible (Onboarding, Betalingen, Rooster, etc.)
2. **"should show onboarding settings"** — click Onboarding tab, expect member invitation section, claim stats
3. **"should show payment settings tab"** — click Betalingen tab, expect payment provider configuration
4. **"should show schedule settings tab"** — click Rooster tab, expect discipline/track configuration
5. **"should restrict admin-only tabs for staff"** — this is a documentation note: admin-only tabs (Gym Profiel, Notificaties, Branding) are gated. Don't test role switching — just verify tabs render for admin.

**`test.describe('Team')`:**
Setup: login as admin, navigate to /team.

6. **"should display team members list"** — expect list of staff members with roles
7. **"should show role badges"** — expect role labels (admin, medewerker, coordinator, coach) visible
8. **"should open add team member form"** — click add button, expect form with name, email, role fields

NOTE: Do NOT create/modify real team members — just verify UI rendering.
  </action>
  <verify>`npx playwright test e2e/settings-team.spec.ts` passes.</verify>
  <done>Settings has 5+ tests, Team has 3+ tests covering tab navigation, content display, and form modals.</done>
</task>

<task type="auto">
  <name>Task 2: Write E2E tests for Dashboard, Shop, Email, GymScreen, KitanaHub</name>
  <files>e2e/dashboard-misc.spec.ts</files>
  <action>
Write `e2e/dashboard-misc.spec.ts` with describe blocks per page:

**`test.describe('Dashboard')`:**
Setup: login as admin, navigate to /.

1. **"should display KPI cards"** — expect cards with member stats (active members, new members, cancellations)
2. **"should show recent activity"** — expect recent activity section or widget
3. **"should have new member quick-action"** — expect "Nieuw lid" button or similar

**`test.describe('Shop Module')`:**
Setup: login as admin, navigate to /shop.

4. **"should display shop dashboard"** — expect shop module page with tabs or trial info
5. **"should show module access info"** — expect trial badge or active status

**`test.describe('Email')`:**
Setup: login as admin, navigate to /email.

6. **"should display email page with tabs"** — expect Templates and Campaigns tabs
7. **"should show template list"** — click Templates tab, expect template list or empty state

**`test.describe('GymScreen')`:**
Setup: login as admin, navigate to /gymscreen.

8. **"should display gym screen manager"** — expect slides section, birthdays section, or settings

**`test.describe('KitanaHub')`:**
Setup: login as admin, navigate to /kitana.

9. **"should display Kitana AI hub"** — expect hero section, chat input, agent function cards
10. **"should show agent function cards"** — expect 6 function cards visible

**`test.describe('Sidebar Navigation')`:**
11. **"should show all main navigation items"** — login as admin, verify sidebar contains: Dashboard, Leden, Leads, Abonnementen, Rooster, Reserveringen, Check-in, Rapporten, Team, Instellingen
12. **"should navigate to each main page"** — click each sidebar item, verify URL changes correctly
  </action>
  <verify>`npx playwright test e2e/dashboard-misc.spec.ts` passes.</verify>
  <done>Dashboard (3), Shop (2), Email (2), GymScreen (1), KitanaHub (2), Sidebar (2) = 12+ test cases all passing.</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Complete E2E test suite covering all 25 pages of the CRM application. Run the full test suite and review results.</what-built>
  <how-to-verify>
    1. Run: `npm run dev` (if not already running)
    2. Run: `npx playwright test` to execute all E2E tests
    3. Review test report: `npx playwright show-report`
    4. Check: All test suites pass (auth, members, leads, subscriptions, checkout, schedule, reservations, check-in, reports, settings, team, dashboard, misc)
    5. Quick manual walkthrough of the app:
       - Login at http://localhost:5173/login
       - Navigate through sidebar: Dashboard, Leden, Leads, Abonnementen, Rooster
       - Open a member detail page
       - Check Settings tabs render
       - Verify no console errors in browser DevTools
    6. Confirm: App works as expected, no critical issues found
  </how-to-verify>
  <resume-signal>Type "approved" to complete Phase 8, or describe issues found for Phase 9 bug tracking</resume-signal>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npx playwright test` — ALL specs pass (10 spec files total)
- [ ] Test report shows 70+ test cases
- [ ] No flaky tests
- [ ] Manual walkthrough confirmed by human
- [ ] Any issues found documented for Phase 9
</verification>

<success_criteria>

- All E2E test suites pass
- Complete page coverage (all 25 pages have at least basic render tests)
- Manual verification confirms app works end-to-end
- Issues documented for Phase 9 (Bug Fixes & Polish)
- Phase 8 complete
</success_criteria>

<output>
After completion, create `.planning/phases/08-functionality-audit-e2e-testing/08-05-SUMMARY.md`:

# Phase 8 Plan 5: Admin Pages & Full Verification Summary

**[Total E2E coverage established: X test cases across Y spec files, manual verification confirmed]**

## Accomplishments
- Settings, Team, Dashboard, Shop, Email, GymScreen, KitanaHub tests
- Sidebar navigation verification
- Full test suite run
- Manual walkthrough confirmed

## Issues Found During Testing
- [List any issues found → track in Phase 9]

## Next Step
Phase 8 complete. Ready for Phase 9 (Bug Fixes & Polish).
</output>
