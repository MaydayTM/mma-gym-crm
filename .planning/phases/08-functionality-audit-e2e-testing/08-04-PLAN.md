---
phase: 08-functionality-audit-e2e-testing
plan: 04
type: execute
depends_on: ["08-01"]
files_modified: [e2e/schedule.spec.ts, e2e/reservations.spec.ts, e2e/checkin-reports.spec.ts]
---

<objective>
Write E2E tests for Schedule management, Reservations, Check-in, and Reports pages.

Purpose: Validate the class scheduling and attendance tracking workflow that members and coaches interact with daily.
Output: Passing E2E test suites for schedule, reservations, check-in, and reports.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-plan.md
./summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/08-functionality-audit-e2e-testing/08-01-SUMMARY.md

# Key source files:
@src/pages/Schedule.tsx
@src/pages/Reservations.tsx
@src/pages/CheckIn.tsx
@src/pages/Reports.tsx
@src/hooks/useClasses.ts
@src/hooks/useReservations.ts

**Established patterns:**
- Weekly/monthly calendar views
- Recurring class creation (bulk)
- Reservation check-in with attendance stats
</context>

<tasks>

<task type="auto">
  <name>Task 1: Write E2E tests for Schedule page</name>
  <files>e2e/schedule.spec.ts</files>
  <action>
Write `e2e/schedule.spec.ts` with `test.describe('Schedule')`:

Setup: `test.beforeEach` — login as admin, navigate to /schedule.

Test cases:
1. **"should display weekly schedule view"** — expect calendar/timetable with day columns visible
2. **"should switch between week and month view"** — if view toggle exists, click it, verify view changes
3. **"should navigate between weeks"** — click next/previous week button, expect date range to change
4. **"should open create class modal"** — click add class button, expect form with fields (discipline, coach, day, time, room, capacity)
5. **"should show existing classes on schedule"** — if classes exist, expect class blocks visible with discipline name and time
6. **"should filter by discipline"** — if discipline filter exists, select one, verify only matching classes show
7. **"should open class detail on click"** — click an existing class block, expect edit modal or detail view

NOTE: Be careful creating test classes — use obvious test names like "[TEST] Testles" and clean up after. Avoid creating recurring classes in tests (too many records to clean up).
  </action>
  <verify>`npx playwright test e2e/schedule.spec.ts` passes.</verify>
  <done>Schedule spec has 7+ test cases covering calendar display, navigation, create modal, filters, and class interaction.</done>
</task>

<task type="auto">
  <name>Task 2: Write E2E tests for Reservations page</name>
  <files>e2e/reservations.spec.ts</files>
  <action>
Write `e2e/reservations.spec.ts` with `test.describe('Reservations')`:

Setup: `test.beforeEach` — login as admin, navigate to /reservations.

Test cases:
1. **"should display weekly reservation view"** — expect week view with class slots
2. **"should show class slots with capacity info"** — expect classes listed with spots available/total
3. **"should navigate between weeks"** — click next week, expect dates to update
4. **"should show reservation details for a class"** — click on a class, expect list of reserved members or empty state
5. **"should show attendance stats"** — expect check-in count vs reservation count for classes

NOTE: Do NOT make actual reservations in tests — just verify the UI displays correctly. Reservation creation requires a valid member + class combination that varies by environment.
  </action>
  <verify>`npx playwright test e2e/reservations.spec.ts` passes.</verify>
  <done>Reservations spec has 5+ test cases covering display, navigation, and capacity information.</done>
</task>

<task type="auto">
  <name>Task 3: Write E2E tests for CheckIn and Reports pages</name>
  <files>e2e/checkin-reports.spec.ts</files>
  <action>
Write `e2e/checkin-reports.spec.ts` with two describe blocks:

**`test.describe('Check-In')`:**
Setup: login as admin, navigate to /checkin.

1. **"should display check-in page"** — expect check-in interface visible (code input or QR area)
2. **"should show today's stats"** — expect today's check-in count, expected attendees
3. **"should show today's class schedule"** — expect list of today's classes with reservation counts
4. **"should handle invalid check-in code"** — if manual code input exists, enter invalid code, expect error

**`test.describe('Reports')`:**
Setup: login as admin, navigate to /reports.

5. **"should display reports dashboard"** — expect stats cards (total members, check-ins, disciplines)
6. **"should show period selector"** — expect period buttons (7d, 30d, 90d, 365d)
7. **"should switch report periods"** — click different period, expect data/charts to update
8. **"should display chart visualizations"** — expect at least one chart/graph element visible
  </action>
  <verify>`npx playwright test e2e/checkin-reports.spec.ts` passes.</verify>
  <done>CheckIn has 4+ tests, Reports has 4+ tests. All verify UI rendering and interactivity.</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npx playwright test e2e/schedule.spec.ts` passes
- [ ] `npx playwright test e2e/reservations.spec.ts` passes
- [ ] `npx playwright test e2e/checkin-reports.spec.ts` passes
- [ ] No test data left behind (classes, reservations)
- [ ] Tests handle empty data state gracefully
</verification>

<success_criteria>

- All 3 spec files written and passing
- 16+ E2E test cases for schedule, reservations, check-in, and reports
- Calendar navigation and view switching verified
- Tests robust against empty or populated data states
</success_criteria>

<output>
After completion, create `.planning/phases/08-functionality-audit-e2e-testing/08-04-SUMMARY.md`
</output>
